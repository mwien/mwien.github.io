---
title: 'Checking Transitivity and Morality of DAGs'
description: 'By Marcel Wien√∂bst. This blog post is on the time complexity of detecting certain induced subgraphs in DAGs. It shows fascinating differences even for structurally close DAGs.'
pubDate: 'September 21 2023'
heroImage: '/blog-placeholder-5.jpg'
---

#### Main Observation

This blog post is about a simple but fascinating observation I stumbled onto recently. Consider a *directed acyclic graph* (DAG) and the task of checking whether it is transitive, i.e., whether $a \rightarrow b \rightarrow c$ implies $a \rightarrow c$. See the following example:

Here, $c \rightarrow b \rightarrow d$ is in the graph, but $c$ and $d$ are non-adjacent making the graph not transitive. 
It is rather easy to show that this task is as hard as detecting whether an undirected graph contains a triangle $a - b - c$ and $a - c$ (see for example TODO and more details below), which is not known to be solvable in linear-time in the size of the graph despite considerable algorithmic efforts (try to come up with a linear-time algorithm and you can write a very nice paper if you succeed!).

The main point of this article is that the similar-looking problem of checking whether a DAG contains $a \rightarrow b \leftarrow c$, with $a$ and $c$ non-adjacent, *can* be solved by a simple algorithm in linear-time! This problem is known as *morality* check (are the parents of vertex $b$ *married*, that is are they adjacent?) and stems from the Bayesian network/Causality literature (TODO: refs). Again let's look at an example graph:



Both problems can be phrased in the context of *subgraph isomorphism*. Given a graph $G$, determine for a (in our case) fixed graph $H$, whether $H$ is an induced[^1] subgraph of $G$.

[^1]: Induced means that the non-adjacencies in $H$ also have to be present in the corresponding subgraph of $G$, e.g., $a - b - c$ is a subgraph of the triangle graph, but not an induced one.

Then, for DAGs, this problem is computationally harder for $H = a \rightarrow b \rightarrow c$ than $H = a \rightarrow b \leftarrow c$. That seems weird at first, right? Hopefully, at the end of this blog post you have an intuition why this is the case!

A short disclaimer: Most (if not all) observations and facts I present here are already known, though somewhat strewn over the literature. I give references whenever possible, in case I missed something relevant, feel free to contact me :)

#### Undirected Graphs

Looking a bit more closely, this phenomenon, that different choices of $H$ even with the same number of vertices, lead to different complexities is not so unique. For example, consider the subgraph isomorphism problem for $H = a - b - c, a - c$, i.e., a triangle, and $H = a - b - c$, i.e., a path of length two. Then, the former one is hard (or at least no linear-time algorithm is known). However, the latter one is almost trivial. Just find the connected components of $G$ and check whether each of them is a clique (can be done by counting edges). There are more cases than this, e.g., this paper looked at all 4-node choices for $H$. More generally, the hardness of detecting $H$ is connected to the treewidth of it (at least asymptotically). TODO

TODO: more and zwick

#### Triangle Hardness of $a \rightarrow b \rightarrow c$

Using a reduction, it is very easy to show that detecting $a \rightarrow b \rightarrow c$ is as hard as detecting a triangle in an undirected graph. This reduction is, e.g., given here https://cstheory.stackexchange.com/a/21510.

TODO

#### Linear-Time Algorithm for $a \rightarrow c \leftarrow c$

In contrast, checking whether a graph is moral is possible in linear-time. The algorithm we give below is based on the one for checking whether a graph has zero *fill-in* given here TODO. It relies on the fact that a graph has zero fill-in if, and only if, it does not contain $ a \rightarrow b \leftarrow c$

Finally, consider the reduction from above. Obviously, it cannot work in this case anymore. The reason is TODO


#### Conclusion

TODO

The algorithm explicitly uses the topological ordering of the vertices. If the graph is cyclic (let's say there is still only one edge between any pair of vertices, e.g., we consider *oriented graphs*), it is unclear to me whether it is possible to solve the problem in linear-time. I tend to think it has similar hardness to triangle-detection, but it is not directly clear how to prove this by reduction.

